<!DOCTYPE html>
<html lang="en">
<head>
    <script src="js/p5/p5/p5.js"></script>
    <script src="js/p5/p5/addons/p5.dom.js"></script>
    <script src="js/p5/p5/addons/p5.sound.js"></script>
    <script src="js/rw.js"></script>
    <link rel="stylesheet" type="text/css" href="css/semantic/semantic.min.css">
    <link rel="stylesheet" type="text/css" href="css/styles.css">
    <script src="js/jquery.js"></script>
    <script src="js/semantic.js"></script>
    <script src="js/plotly-latest.min.js"></script>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body style="background: cadetblue">
<div class="container">
    <h3 style="text-align: center">Calculadora de secuencias</h3>
    <div class="ui grid" id="workspace">

    </div>
</div>

<br/>
<br/>
<br/>
<br/>
<br/>

<div class="ui grid container" style="padding-bottom: 10px">
    <div class="row">
        <div class="six wide centered column">
            <h3 style="text-align: center">Agregar Secuencia</h3>
            <div class="ui input" style="width: 65%">
                <input type="text" id="sequenceInput" placeholder="Ingresar secuencia"/>
            </div>
            <button class="ui button orange" style="width: 30%" onclick="addSequence(event)">Agregar</button>
        </div>
    </div>
    <div class="row">
        <div class="six wide centered column">
            <div class="ui grid">
                <button class="ui button five wide column orange" onclick="record(event)" id="record">Grabar</button>
                <button class="ui button five wide column orange" onclick="startSound(event)">Reproducir</button>
                <button class="ui button five wide column orange" onclick="addSequenceSound(event)">Agregar sonido</button>
            </div>
        </div>
    </div>
    <!--
    <p>1,2,4,#3,2,3</p>
    <p>10, -0.5#, 4, 2, -1, 11</p>
    <p>4, 5, -1#, 2</p>
    <p>...,-5,0#,1,...</p>
    <p>...,-2,4#,8,...</p>
    <p>...,4,1,5#,6,-2,...</p>
    <p>...,0#,4,3,1,...</p>
    -->

    <div class="centered row">
        <h3 style="text-align: center">Operaciones entre secuencias</h3>
    </div>
    <div class="centered row">
        <select class="ui dropdown" onchange="select_op(this.value)">
            <option disabled selected>Operaci贸n</option>
            <option value="suma">Suma</option>
            <option value="resta">Resta</option>
            <option value="mult">Multiplicaci贸n</option>
            <option value="conv">Convoluci贸n</option>
        </select>
        <select class="ui dropdown" id="secuenciasOP1" onchange="setA(this.value)">
            <option disabled selected>Secuencia A</option>
        </select>
        <select class="ui dropdown" id="secuenciasOP2" onchange="setB(this.value)">
            <option disabled selected>Secuencia B</option>
        </select>
        <button class="ui orange button" onclick="startOP()">Realizar Operaci贸n</button>
    </div>
</div>


<div class="ui modal" id="modalGraf" style="width: 90%; height: 90%;">
    <div class="ui centered grid">
        <div class="row">
            <div class="modal container" id="chart"></div>
        </div>
    </div>
</div>
</body>
</html>
<script src="js/start.js"></script>
<script src="js/secuencia.js"></script>
<script src="js/op_secuence.js"></script>
<script>
    let mic;
    let recorder;
    let soundFile;
    let state = 0;
    let amp_hist = [];
    let amp;
    let recording = false;
    let osc;
    function setup() {
        mic = new p5.AudioIn();
        mic.start();
        recorder = new p5.SoundRecorder();
        recorder.setInput(mic);
        soundFile = new p5.SoundFile();
        amp = new p5.Amplitude();
        createCanvas(window.innerWidth, 280);
        osc = new p5.Oscillator();
        osc.setType('sine');


    }

    function draw() {
        background(255);
        let rms = amp.getLevel();
        if (recording)
            amp_hist.push(rms);
        fill(0, 102, 204);
        stroke(100);
        ellipse(width / 2, height / 2, 30 + rms * 200, 30 + rms * 200);
    }

    function startSound() {
        if (soundFile !== undefined) {
            if (soundFile.isPlaying()) {
                soundFile.stop();
            } else {
                soundFile.play();
            }
        }
    }

    function record() {
        amp_hist = [];
        recording = true;
        $('#record').removeClass('orange');
        $('#record').addClass('red');
        if (mic.enabled) {
            recorder.record(soundFile);
            amp.setInput(mic);
            setTimeout(() => {
                recorder.stop();
                recording = false;
                $('#record').removeClass('red');
                $('#record').addClass('orange');
            }, 3000);
        }
    }

    function myFunction() {
        //let data = [0, 0, 0.003533119360751631, 0.003533119360751631, 0.003533119360751631, 0.003769771642042603, 0.003769771642042603, 0.004270483291888013, 0.004270483291888013, 0.004270483291888013, 0.004270483291888013, 0.004334411262976823, 0.004334411262976823, 0.0041466000472267315, 0.0041466000472267315, 0.0041466000472267315, 0.005070218522939216, 0.005070218522939216, 0.00453856848320255, 0.00453856848320255, 0.00453856848320255, 0.00453856848320255, 0.006680135316192864, 0.006680135316192864, 0.005343839854299783, 0.005343839854299783, 0.005343839854299783, 0.005212343707226225, 0.005212343707226225, 0.005212343707226225, 0.003964929637404045, 0.003964929637404045, 0.003964929637404045, 0.005253960025507589, 0.005253960025507589, 0.024354621684171483, 0.024354621684171483, 0.024354621684171483, 0.008661438160710733, 0.008661438160710733, 0.008661438160710733, 0.004387475212609132, 0.004387475212609132, 0.004387475212609132, 0.0034667432352574303, 0.0034667432352574303, 0.03873058480165395, 0.03873058480165395, 0.03873058480165395, 0.03873058480165395, 0.012037835252235368, 0.012037835252235368, 0.005188355052837695, 0.005188355052837695, 0.005188355052837695, 0.0028307075673987088, 0.0028307075673987088, 0.004848488217538828, 0.004848488217538828, 0.004848488217538828, 0.004848488217538828, 0.015316693524511198, 0.015316693524511198, 0.003972130595505528, 0.003972130595505528, 0.003972130595505528, 0.02780799291571636, 0.02780799291571636, 0.02780799291571636, 0.02780799291571636, 0.004316491289631854, 0.004316491289631854, 0.003861283820725825, 0.003861283820725825, 0.003676795013269493, 0.003676795013269493, 0.003676795013269493, 0.013644890906813433, 0.013644890906813433, 0.013644890906813433, 0.004729406332895515, 0.004729406332895515, 0.004729406332895515, 0.015830301638950568, 0.015830301638950568, 0.007782813663134134, 0.007782813663134134, 0.007782813663134134, 0.007782813663134134, 0.005216128043012035, 0.005216128043012035, 0.004192622946332153, 0.004192622946332153, 0.004192622946332153, 0.00837051938193364, 0.00837051938193364, 0.008636534908039875, 0.008636534908039875, 0.008636534908039875, 0.008636534908039875, 0.006341230413253932, 0.006341230413253932, 0.025051650468561844, 0.025051650468561844, 0.025051650468561844, 0.007778464075049004, 0.007778464075049004, 0.007778464075049004, 0.00465492364671841, 0.00465492364671841, 0.00465492364671841, 0.004257151392614931, 0.004257151392614931, 0.007940316446070569, 0.007940316446070569, 0.007940316446070569, 0.008347778194246737, 0.008347778194246737, 0.008347778194246737, 0.005247064489140961, 0.005247064489140961, 0.005247064489140961, 0.01374763400098226, 0.01374763400098226, 0.0057470925447174834, 0.0057470925447174834, 0.0057470925447174834, 0.0057470925447174834, 0.0032965243786119347, 0.0032965243786119347, 0.004534921250427686, 0.004534921250427686, 0.004534921250427686, 0.014145749214739564, 0.014145749214739564, 0.0055540629501538, 0.0055540629501538, 0.0055540629501538, 0.0055540629501538, 0.020791400554912853, 0.020791400554912853, 0.008873781818872144, 0.008873781818872144, 0.008873781818872144, 0.0044222358760912395, 0.0044222358760912395, 0.0044222358760912395, 0.020673356888348572, 0.020673356888348572, 0.020673356888348572, 0.01403781081247788, 0.01403781081247788, 0.005060140098914725, 0.005060140098914725, 0.005060140098914725, 0.005070783881916246, 0.005070783881916246, 0.005070783881916246, 0.005070783881916246, 0.005200765019127578, 0.005200765019127578, 0.0026094240260499013, 0.0026094240260499013, 0.0359992957728714, 0.0359992957728714, 0.0359992957728714, 0.0359992957728714, 0.005339135658698993, 0.005339135658698993, 0.0037631839709667955, 0.0037631839709667955, 0.0037631839709667955, 0.004500407326856255, 0.004500407326856255, 0.0048338885342367735, 0.0048338885342367735, 0.0048338885342367735, 0.0048338885342367735, 0.007832903631994553, 0.007832903631994553];
        let data = [0, 0.00384773407252483, 0.00384773407252483, 0.00384773407252483, 0.005456650481241491, 0.005456650481241491, 0.005456650481241491, 0.003956164894566267, 0.003956164894566267, 0.003956164894566267, 0.003892156996754887, 0.003892156996754887, 0.004087821326580449, 0.004087821326580449, 0.004087821326580449, 0.006319611353654984, 0.006319611353654984, 0.006319611353654984, 0.005390810040620367, 0.005390810040620367, 0.005390810040620367, 0.05133265773694077, 0.05133265773694077, 0.008240301860443035, 0.008240301860443035, 0.008240301860443035, 0.008240301860443035, 0.00496321844697862, 0.00496321844697862, 0.005160117599755145, 0.005160117599755145, 0.005160117599755145, 0.004783614022510079, 0.004783614022510079, 0.0054146726073611325, 0.0054146726073611325, 0.0054146726073611325, 0.0054146726073611325, 0.005139633229005149, 0.005139633229005149, 0.003423526094956098, 0.003423526094956098, 0.003423526094956098, 0.0036610879046344576, 0.0036610879046344576, 0.0036610879046344576, 0.006012785613585301, 0.006012785613585301, 0.006012785613585301, 0.003583031471355356, 0.003583031471355356, 0.00329966869430814, 0.00329966869430814, 0.00329966869430814, 0.00428986840844285, 0.00428986840844285, 0.00428986840844285, 0.0050972787537013585, 0.0050972787537013585, 0.0050972787537013585, 0.003921183918202941, 0.003921183918202941, 0.0031002201116594724, 0.0031002201116594724, 0.0031002201116594724, 0.0031002201116594724, 0.051234920808718686, 0.051234920808718686, 0.008064871264923919, 0.008064871264923919, 0.008064871264923919, 0.0033948840314914817, 0.0033948840314914817, 0.0037067067960071393, 0.0037067067960071393, 0.0037067067960071393, 0.0037067067960071393, 0.0030339517476819233, 0.0030339517476819233, 0.004804969408019245, 0.004804969408019245, 0.004804969408019245, 0.004005225013084509, 0.004005225013084509, 0.004005225013084509, 0.003178545127707498, 0.003178545127707498, 0.003178545127707498, 0.006258659713897073, 0.006258659713897073, 0.0035524347811501066, 0.0035524347811501066, 0.0035524347811501066, 0.004514562289826739, 0.004514562289826739, 0.004514562289826739, 0.005333631655308714, 0.005333631655308714, 0.005333631655308714, 0.00526455823389463, 0.00526455823389463, 0.0042014016511854775, 0.0042014016511854775, 0.0042014016511854775, 0.0042014016511854775, 0.005128486925453498, 0.005128486925453498, 0.00231353622435822, 0.00231353622435822, 0.00231353622435822, 0.0038192086732639825, 0.0038192086732639825, 0.058140032132556356, 0.058140032132556356, 0.058140032132556356, 0.058140032132556356, 0.01861372254404963, 0.01861372254404963, 0.007728816539532838, 0.007728816539532838, 0.007728816539532838, 0.0040865772048300645, 0.0040865772048300645, 0.0040865772048300645, 0.0041287409901877795, 0.0041287409901877795, 0.003421140068426507, 0.003421140068426507, 0.004861249807031905, 0.004861249807031905, 0.004861249807031905, 0.005985262314703841, 0.005985262314703841, 0.005985262314703841, 0.0034511825080104103, 0.0034511825080104103, 0.0034511825080104103, 0.0023564623013376243, 0.0023564623013376243, 0.004235596954626651, 0.004235596954626651, 0.004235596954626651, 0.004235596954626651, 0.0028205385332398863, 0.0028205385332398863, 0.0034370953798270832, 0.0034370953798270832, 0.0034370953798270832, 0.0070362495315307565, 0.0070362495315307565, 0.002797534020769036, 0.002797534020769036, 0.002797534020769036, 0.002797534020769036, 0.004651138036599602, 0.004651138036599602, 0.005242471486539798, 0.005242471486539798, 0.005242471486539798, 0.0025856157231438823, 0.0025856157231438823, 0.0025856157231438823, 0.003789846476389058, 0.003789846476389058, 0.003789846476389058, 0.003991726685493087, 0.003991726685493087, 0.004395413744678342, 0.004395413744678342, 0.004395413744678342, 0.0021650944394182438, 0.0021650944394182438, 0.0021650944394182438, 0.0030106372088080724, 0.0030106372088080724, 0.0030106372088080724, 0.004078495148836759, 0.004078495148836759, 0.003351507891650331]
        let data2 = [];
        for (let i = 0; i < data.length; i++) {
            for (let j = 0; j < 300; j++) {
                data2.push(data[i] * 1500);
            }
        }
            let wave = new RIFFWAVE(data2); // create the wave file
            let audio = new Audio(wave.dataURI); // create the HTML5 audio element
            audio.play();
    }
</script>

